<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CoBot — find co-ops, commons & community organisations worldwide</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://unpkg.com/maplibre-gl@4.1.2/dist/maplibre-gl.css">
  <script src="https://unpkg.com/maplibre-gl@4.1.2/dist/maplibre-gl.js"></script>
</head>
<body>
  <header id="header">
    <div class="header-left">
      <h1>Co<span class="accent">Bot</span></h1>
      <span class="tagline">find co-ops, commons & community organisations worldwide</span>
    </div>

    <!-- Mode toggle -->
    <div class="mode-switch">
      <button class="mode-btn active" data-mode="chat">Chat</button>
      <button class="mode-btn" data-mode="search">Search</button>
    </div>

    <!-- Search input (search mode only) -->
    <div class="search-wrap hidden" id="search-wrap">
      <input type="text" id="search-input" placeholder="e.g. community energy cooperatives in Wales" autocomplete="off" />
      <div class="search-hint">Press Enter or wait to search</div>
    </div>

    <span id="profile-count" class="count"></span>

    <div class="header-right">
      <nav class="header-nav">
        <a href="/about.html" class="nav-link">About</a>
        <a href="/add-data.html" class="nav-link">Add data</a>
        <a href="https://opencollective.com/murmurations" target="_blank" rel="noopener" class="nav-link">Donate</a>
      </nav>
    </div>
  </header>

  <main id="main">
    <aside id="sidebar">
      <!-- Search mode content -->
      <div id="search-panel" class="hidden">
        <div id="synthesis" class="synthesis hidden"></div>
        <div id="results"></div>
        <div id="empty-state" class="empty-state">
          <p>Type a query to search <strong id="empty-count"></strong> co-ops, commons & community organisations worldwide.</p>
          <p class="examples">Try: <a href="#" class="try-link" onclick="fireTrySearch(this); return false;">permaculture projects in France</a>, <a href="#" class="try-link" onclick="fireTrySearch(this); return false;">housing cooperatives</a>, <a href="#" class="try-link" onclick="fireTrySearch(this); return false;">transition towns UK</a></p>
        </div>
      </div>

      <!-- Chat mode content -->
      <div id="chat-panel" class="hidden">
        <div id="chat-messages">
          <div class="chat-msg assistant chat-welcome" style="visibility:hidden">
            <div class="chat-bubble">
              <p>Hey! I'm CoBot — I search a directory of over 16,000 co-ops, community projects and commons organisations across 129 countries. Try things like <a href="#" class="try-link" onclick="fireTryQuery(this); return false;">community energy in Wales</a> or <a href="#" class="try-link" onclick="fireTryQuery(this); return false;">open source projects in Berlin</a> or just name a place to see what's there.</p>

            </div>
          </div>
        </div>
        <div id="chat-input-wrap">
          <input type="text" id="chat-input" placeholder="Ask CoBot anything..." autocomplete="off" />
          <button id="chat-send" title="Send">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
          </button>
        </div>
      </div>
    </aside>
    <div id="map"></div>
  </main>

  <script type="module" src="app.js"></script>
</body>
</html>
